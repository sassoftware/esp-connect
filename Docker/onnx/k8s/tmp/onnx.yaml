apiVersion: iot.sas.com/v1alpha1
kind: ESPServer
metadata:
  name: onnx # give the service used to access the running project a name
  #     ingress is <name>.<namespace>.$ESP_DOMAIN
  namespace: roleve
spec:
  # Add fields here
  failover: false
  loadBalancePolicy: "default" # in the future, we could add cluster-manager hash/round-robin...
  # if model has prefix "b64", treat it as based64 encoded 
  model: ""
  espProperties:
    server.xml: "b64PD94bWwgdmVyc2lvbj0iMS4wIj8+Cjxwcm9qZWN0IHB1YnN1Yj0iYXV0byIgdGhyZWFkcz0iNCIgdXNlLXRhZ2dlZC10b2tlbj0idHJ1ZSIgbmFtZT0ib25ueCI+CiAgPG1hcy1tb2R1bGVzPgogICAgPG1hcy1tb2R1bGUgbGFuZ3VhZ2U9InB5dGhvbiIgbW9kdWxlPSJ0ZW5zb3JQcm9jZXNzIiBmdW5jLW5hbWVzPSJwcmVwcm9jZXNzLHBvc3Rwcm9jZXNzIj4KICAgICAgPGNvZGU+CiAgICAgIDwhW0NEQVRBWwogICAgICAjISAvdXNyL2xvY2FsL2Jpbi9weXRob24zLjcKCmltcG9ydCBvcywgc3lzCmltcG9ydCBudW1weSBhcyBucAoKZnJvbSBfbW9kdWxlcy5pbnB1dF9wcmVwcm9jIGltcG9ydCBQcmVQcm9jZXNzCmltcG9ydCBfbW9kdWxlcy51dGlscyBhcyB1dGlscwppbXBvcnQgX21vZHVsZXMudGVuc29yX3V0aWxzIGFzIHRlbnNvcl91dGlscwoKYXJnc19tb2RlbHNfZGlyID0gIi9tbnQvZGF0YS9vbm54L01vZGVscyIKYXJnc19tb2RlbF9tZXRhZGF0YSA9ICJ0aW55LXlvbG92Mi9Nb2RlbFpvby10aW55eW9sb3YyLTgub25ueCIKCm1vZGVsX3BhdGggPSBvcy5wYXRoLmRpcm5hbWUoYXJnc19tb2RlbF9tZXRhZGF0YSkKCiNJbml0IFBoYXNlCnN5cy5wYXRoLmFwcGVuZChhcmdzX21vZGVsc19kaXIpCm1vZGVsX21ldGFkYXRhID0gdXRpbHMubG9hZF9tb2R1bGUoYXJnc19tb2RlbF9tZXRhZGF0YSkKcHJlX3Byb2Nlc3MgPSBQcmVQcm9jZXNzKG1vZGVsX21ldGFkYXRhLmlucHV0c19wYXJhbWV0ZXJzLCBtb2RlbF9tZXRhZGF0YS5vbm54X21vZGVsX3R5cGUpCmRlY29kZV9tb2R1bGUgPSB1dGlscy5sb2FkX21vZHVsZShvcy5wYXRoLmpvaW4obW9kZWxfcGF0aCwgbW9kZWxfbWV0YWRhdGEub3V0cHV0X2RlY29kZXIpKQpkZWNvZGVfZGVjb2RlciA9IGRlY29kZV9tb2R1bGUuRGVjb2Rlcihtb2RlbF9tZXRhZGF0YS5vdXRwdXRfZGVjb2Rlcl9wYXJhbWV0ZXJzLCBtb2RlbF9tZXRhZGF0YS5pbnB1dHNfcGFyYW1ldGVycykKCgpkZWYgcHJlcHJvY2VzcyhpZCwgaW1hZ2UpOgogICAgIk91dHB1dDogaWQsIHRlbnNvciIKCiAgICBpbWdfbnAgPSB0ZW5zb3JfdXRpbHMuSW1hZ2UyQXJyYXkoaW1hZ2UpCgogICAgaW5mZXJlbmNlX2lucHV0ID0gcHJlX3Byb2Nlc3MucHJvY2VzcyhpbWdfbnApCgogICAgdGVuc29yID0gdGVuc29yX3V0aWxzLkFycmF5MlRlbnNvcihpbmZlcmVuY2VfaW5wdXRbMF0pCgogICAgcmV0dXJuIGlkLCB0ZW5zb3IKCgpkZWYgcG9zdHByb2Nlc3MoaWQsIHRlbnNvcl9vdXQpOgogICAgIk91dHB1dDogaWQsIG1vZGVsX25hbWUsIG1vZGVsX3R5cGUsIG5fb2JqZWN0cywgY29vcmRzLCBjb29yZHNfdHlwZSwgc2NvcmVzLCBsYWJlbHMiCgogICAgdGVuc29yLCB0ZW5zb3JfZGltcyA9IHRlbnNvcl91dGlscy5UZW5zb3IyQXJyYXkodGVuc29yX291dCkKICAgIHRlbnNvciA9IHRlbnNvci5yZXNoYXBlKCp0ZW5zb3JfZGltcykKCiAgICB0ZW5zb3JfZXhwID0gbnAuZXhwYW5kX2RpbXModGVuc29yLCBheGlzPTApCgogICAgI3NoYXBlIG9mIG9yaWdpbmFsIGltYWdlIG5lZWQgdG8gbm9ybWFsaXplIG91dHB1dC4gbm90IG5lZWRlZCBmb3IgeW9sb3YyIGFuZCB5b2xvdjQKICAgICNpc3ZpZGVvID0gVHJ1ZSBuZWVkZWQgZm9yIG9wZW4gcG9zZSBvbmx5IGlmIGRhdGEgY29tZSBmb3JtIGNhbWVyYXMgb3Igc3RyZWFtaW5nCiAgICBkZWNvZGVkX3Jlc3VsdCA9ICBkZWNvZGVfZGVjb2Rlci5kZWNvZGUodGVuc29yX2V4cCwgdGVuc29yX2RpbXMpCgoKICAgIGJveGVzLCBjbGFzc2VzLCBzY29yZXMgPSBkZWNvZGVkX3Jlc3VsdAoKICAgIGlmIG9zLmVudmlyb24uZ2V0KCdXUklURV9QWVRIT05fUE9TVFBST0NfUkVTVUxUJywgJ2ZhbHNlJykubG93ZXIoKT09InRydWUiOgogICAgICAgIG5wLnNldF9wcmludG9wdGlvbnModGhyZXNob2xkPXN5cy5tYXhzaXplKQogICAgICAgIHdpdGggb3BlbignJXMvb3V0X3RlbnNvcl8lcy50eHQnICUgKG9zLmVudmlyb24uZ2V0KCdERU1PX0hPTUUnLCAnL0RlbW9zLUhvbWUnKSwgb3MuZW52aXJvbi5nZXQoJ1RFU1RfQ09ORklHJywgJycpKSwgJ3cnKSBhcyBmOgogICAgICAgICAgICAjZi53cml0ZShzdHIodGVuc29yKSkKICAgICAgICAgICAgI2Yud3JpdGUoc3RyKHRlbnNvcl9leHApKQogICAgICAgICAgICBmLndyaXRlKCJib3VuZGluZyBib3hlczpcbiIgKyBzdHIoYm94ZXMpICsgIlxuIikKICAgICAgICAgICAgZi53cml0ZSgiY2xhc3NlczpcbiIgKyBzdHIoY2xhc3NlcykgKyAiXG4iKQogICAgICAgICAgICBmLndyaXRlKCJzY29yZXM6XG4iICsgc3RyKHNjb3JlcykgKyAiXG4iKQoKICAgIHJldF9ib3hlcyA9IFtdCiAgICBmb3IgaSBpbiByYW5nZShsZW4oYm94ZXMpKToKICAgICAgICByZXRfYm94ZXMuZXh0ZW5kKGJveGVzW2ldLnRvbGlzdCgpKQogICAgcmV0X2xhYmVsPSIiCiAgICBmb3IgaiBpbiByYW5nZShsZW4oY2xhc3NlcykpOgogICAgICAgcmV0X2xhYmVsKz1tb2RlbF9tZXRhZGF0YS5vdXRwdXRfbGFiZWxzW2ludChjbGFzc2VzW2pdKV0gKyAiLCIKICAgIHJldF9zY29yZXMgPSBucC5hcnJheShzY29yZXMpLnRvbGlzdCgpCgogICAgcmV0dXJuIGlkLCBtb2RlbF9tZXRhZGF0YS5vbm54X21vZGVsLCBtb2RlbF9tZXRhZGF0YS5vbm54X21vZGVsX3R5cGUsIGxlbihib3hlcyksIHJldF9ib3hlcywgbW9kZWxfbWV0YWRhdGEub3V0cHV0X2Nvb3JkX3R5cGUsIHJldF9zY29yZXMsIHJldF9sYWJlbAogICAgICAgICBdXT4KICAgICAgPC9jb2RlPgogICAgPC9tYXMtbW9kdWxlPgogIDwvbWFzLW1vZHVsZXM+CiAgPGNvbnRxdWVyaWVzPgogICAgPGNvbnRxdWVyeSBuYW1lPSJjcSIgdGltaW5nLXRocmVzaG9sZD0iNTAwMCIgdHJhY2U9IndfYWdnciI+CiAgICAgIDx3aW5kb3dzPgogICAgICAgIDx3aW5kb3ctc291cmNlIG5hbWU9IndfZGF0YSIgaW5kZXg9InBpX0VNUFRZIiBpbnNlcnQtb25seT0idHJ1ZSI+CiAgICAgICAgICA8c2NoZW1hPgogICAgICAgICAgICA8ZmllbGRzPgogICAgICAgICAgICAgIDxmaWVsZCBuYW1lPSJpZCIgdHlwZT0iaW50NjQiIGtleT0idHJ1ZSIvPgogICAgICAgICAgICAgIDxmaWVsZCBuYW1lPSJpbWFnZSIgdHlwZT0iYmxvYiIvPgogICAgICAgICAgICA8L2ZpZWxkcz4KICAgICAgICAgIDwvc2NoZW1hPgogICAgICAgIDwvd2luZG93LXNvdXJjZT4KICAgICAgICA8d2luZG93LWNhbGN1bGF0ZSBuYW1lPSJ3X3B5dGhvbjEiIGFsZ29yaXRobT0iTUFTIiBpbmRleD0icGlfRU1QVFkiIHByb2R1Y2VzLW9ubHktaW5zZXJ0cz0idHJ1ZSI+CiAgICAgICAgICA8c2NoZW1hPgogICAgICAgICAgICA8ZmllbGRzPgogICAgICAgICAgICAgIDxmaWVsZCBuYW1lPSJpZCIgdHlwZT0iaW50NjQiIGtleT0idHJ1ZSIvPgogICAgICAgICAgICAgIDxmaWVsZCBuYW1lPSJpbWFnZSIgdHlwZT0iYmxvYiIvPgogICAgICAgICAgICAgIDxmaWVsZCBuYW1lPSJ0ZW5zb3IiIHR5cGU9ImJsb2IiLz4KCiAgICAgICAgICAgIDwvZmllbGRzPgogICAgICAgICAgPC9zY2hlbWE+CiAgICAgICAgICA8bWFzLW1hcD4KICAgICAgICAgICAgPHdpbmRvdy1tYXAgbW9kdWxlPSJ0ZW5zb3JQcm9jZXNzIiByZXZpc2lvbj0iMCIgc291cmNlPSJ3X2RhdGEiIGZ1bmN0aW9uPSJwcmVwcm9jZXNzIi8+CiAgICAgICAgICA8L21hcy1tYXA+CiAgICAgICAgPC93aW5kb3ctY2FsY3VsYXRlPgoKICAgICAgICA8d2luZG93LW1vZGVsLXJlYWRlciBuYW1lPSJ3X3JlYWRlciIgbW9kZWwtdHlwZT0ib25ueCI+CiAgICAgICAgICA8cGFyYW1ldGVycz4KICAgICAgICAgICAgPHByb3BlcnRpZXM+CiAgICAgICAgICAgICAgPHByb3BlcnR5IG5hbWU9InJlZmVyZW5jZSI+L21udC9kYXRhL29ubngvTW9kZWxzL3RpbnkteW9sb3YyL01vZGVsWm9vLXRpbnl5b2xvdjItOC5vbm54PC9wcm9wZXJ0eT4KICAgICAgICAgICAgICA8cHJvcGVydHkgbmFtZT0iZXhlY1Byb3ZpZGVyIj5jcHU8L3Byb3BlcnR5PgogICAgICAgICAgICAgIDxwcm9wZXJ0eSBuYW1lPSJvcGVudmlub0RldmljZVR5cGUiPkNQVV9GUDMyPC9wcm9wZXJ0eT4KICAgICAgICAgICAgPC9wcm9wZXJ0aWVzPgogICAgICAgICAgPC9wYXJhbWV0ZXJzPgogICAgICAgIDwvd2luZG93LW1vZGVsLXJlYWRlcj4KCiAgICAgICAgPHdpbmRvdy1zY29yZSBuYW1lPSJ3X3Njb3JlIj4KICAgICAgICAgIDxzY2hlbWE+CiAgICAgICAgICAgIDxmaWVsZHM+CiAgICAgICAgICAgICAgPGZpZWxkIG5hbWU9ImlkIiB0eXBlPSJpbnQ2NCIga2V5PSJ0cnVlIi8+CiAgICAgICAgICAgICAgPGZpZWxkIG5hbWU9ImltYWdlIiB0eXBlPSJibG9iIi8+CiAgICAgICAgICAgICAgPGZpZWxkIG5hbWU9InRlbnNvcl9vdXQiIHR5cGU9ImJsb2IiLz4KICAgICAgICAgICAgPC9maWVsZHM+CiAgICAgICAgICA8L3NjaGVtYT4KICAgICAgICAgIDxtb2RlbHM+CiAgICAgICAgICAgIDxvZmZsaW5lIG1vZGVsLXR5cGU9Im9ubngiPgogICAgICAgICAgICAgIDxpbnB1dC1tYXA+CiAgICAgICAgICAgICAgICA8cHJvcGVydGllcz4KICAgICAgICAgICAgICAgIDwhLS0gU0FTIG1vZGVscyBhbmQgTW9kZWwgWm9vIG9uZXMgaGFzIGRpZmZlcmVudCBpbnB1dHMgCiAgICAgICAgICAgICAgICAgICAgIHRoaXMgZG91YmxlIGRlY2xhcmF0aW9uIGVuc3VyZSB0aGF0IGJvdGggd29ya3MtLT4KICAgICAgICAgICAgICAgICAgPHByb3BlcnR5IG5hbWU9ImltYWdlIj50ZW5zb3I8L3Byb3BlcnR5PgogICAgICAgICAgICAgICAgICA8cHJvcGVydHkgbmFtZT0iaW5wdXQxIj50ZW5zb3I8L3Byb3BlcnR5PgogICAgICAgICAgICAgICAgPC9wcm9wZXJ0aWVzPgogICAgICAgICAgICAgIDwvaW5wdXQtbWFwPgogICAgICAgICAgICAgIDxvdXRwdXQtbWFwPgogICAgICAgICAgICAgICAgPHByb3BlcnRpZXM+CiAgICAgICAgICAgICAgICA8IS0tIFNBUyBtb2RlbHMgYW5kIE1vZGVsIFpvbyBvbmVzIGhhcyBkaWZmZXJlbnQgaW5wdXRzIAogICAgICAgICAgICAgICAgICAgICB0aGlzIGRvdWJsZSBkZWNsYXJhdGlvbiBlbnN1cmUgdGhhdCBib3RoIHdvcmtzLS0+ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgPHByb3BlcnR5IG5hbWU9ImdyaWQiPnRlbnNvcl9vdXQ8L3Byb3BlcnR5PgogICAgICAgICAgICAgICAgICA8cHJvcGVydHkgbmFtZT0iY29udm8uOSI+dGVuc29yX291dDwvcHJvcGVydHk+CiAgICAgICAgICAgICAgICA8L3Byb3BlcnRpZXM+CiAgICAgICAgICAgICAgPC9vdXRwdXQtbWFwPgogICAgICAgICAgICA8L29mZmxpbmU+CiAgICAgICAgICA8L21vZGVscz4KICAgICAgICA8L3dpbmRvdy1zY29yZT4KICAgICAgICA8d2luZG93LWNhbGN1bGF0ZSBuYW1lPSJ3X2NhbGMiIGFsZ29yaXRobT0iTUFTIiBpbmRleD0icGlfRU1QVFkiPgogICAgICAgICAgPHNjaGVtYT4KICAgICAgICAgICAgPGZpZWxkcz4KICAgICAgICAgICAgICA8ZmllbGQgbmFtZT0iaWQiIHR5cGU9ImludDY0IiBrZXk9InRydWUiLz4KICAgICAgICAgICAgICA8ZmllbGQgbmFtZT0iaW1hZ2UiIHR5cGU9ImJsb2IiLz4gIAogICAgICAgICAgICAgIDxmaWVsZCBuYW1lPSJtb2RlbF9uYW1lIiB0eXBlPSJzdHJpbmciLz4KICAgICAgICAgICAgICA8ZmllbGQgbmFtZT0ibW9kZWxfdHlwZSIgdHlwZT0ic3RyaW5nIi8+CiAgICAgICAgICAgICAgPGZpZWxkIG5hbWU9Im5fb2JqZWN0cyIgdHlwZT0iZG91YmxlIi8+CiAgICAgICAgICAgICAgPGZpZWxkIG5hbWU9ImNvb3JkcyIgdHlwZT0iYXJyYXkoZGJsKSIvPgogICAgICAgICAgICAgIDxmaWVsZCBuYW1lPSJjb29yZHNfdHlwZSIgdHlwZT0ic3RyaW5nIi8+CiAgICAgICAgICAgICAgPGZpZWxkIG5hbWU9InNjb3JlcyIgdHlwZT0iYXJyYXkoZGJsKSIvPgogICAgICAgICAgICAgIDxmaWVsZCBuYW1lPSJsYWJlbHMiIHR5cGU9InN0cmluZyIvPgogICAgICAgICAgICA8L2ZpZWxkcz4KICAgICAgICAgIDwvc2NoZW1hPgogICAgICAgICAgPG1hcy1tYXA+CiAgICAgICAgICAgIDx3aW5kb3ctbWFwIG1vZHVsZT0idGVuc29yUHJvY2VzcyIgcmV2aXNpb249IjAiIHNvdXJjZT0id19zY29yZSIgZnVuY3Rpb249InBvc3Rwcm9jZXNzIi8+CiAgICAgICAgICAgIDwvbWFzLW1hcD4KICAgICAgICA8L3dpbmRvdy1jYWxjdWxhdGU+CiAgICAgICAgPHdpbmRvdy1sdWEgbmFtZT0id19jb3VudCIgZXZlbnRzPSJjcmVhdGUiIGluZGV4PSJwaV9FTVBUWSI+CiAgICAgICAgICA8c2NoZW1hPgogICAgICAgICAgICA8ZmllbGRzPgogICAgICAgICAgICAgIDxmaWVsZCBuYW1lPSJpZCIgdHlwZT0iaW50NjQiIGtleT0idHJ1ZSIvPgogICAgICAgICAgICAgIDxmaWVsZCBuYW1lPSJpdGVtIiB0eXBlPSJzdHJpbmciLz4KICAgICAgICAgICAgICA8ZmllbGQgbmFtZT0ic2NvcmUiIHR5cGU9ImRvdWJsZSIvPgogICAgICAgICAgICA8L2ZpZWxkcz4KICAgICAgICAgIDwvc2NoZW1hPgogICAgICAgICAgPHVzZT5zY29yZXMsbGFiZWxzPC91c2U+CiAgICAgICAgICA8Y29kZT48IVtDREFUQVsKICAgICAgICAgICAgbG9jYWwgICBpZCA9IDEKCiAgICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZShkYXRhLGNvbnRleHQpCiAgICAgICAgICAgICAgICBsb2NhbCAgIGV2ZW50cyA9IG5pbAoKICAgICAgICAgICAgICAgIGlmIChkYXRhLmxhYmVscyB+PSBuaWwgYW5kIGRhdGEuc2NvcmVzIH49IG5pbCkKICAgICAgICAgICAgICAgIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCAgIGkxID0gMQogICAgICAgICAgICAgICAgICAgIGxvY2FsICAgaTIgPSAxCgogICAgICAgICAgICAgICAgICAgIGZvciBzIGluIHN0cmluZy5nbWF0Y2goZGF0YS5sYWJlbHMsIihbXixdKykiKQogICAgICAgICAgICAgICAgICAgIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnNjb3Jlc1tpMV0gfj0gbmlsKQogICAgICAgICAgICAgICAgICAgICAgICB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCAgIGUgPSB7fQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5pZCA9IGlkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLml0ZW0gPSBzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnNjb3JlID0gZGF0YS5zY29yZXNbaTFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnRzID09IG5pbCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudHMgPSB7fQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudHNbaTJdID0gZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaTEgPSBpMSArIDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkyID0gaTIgKyAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCA9IGlkICsgMQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIHJldHVybiBldmVudHMKICAgICAgICAgICAgZW5kCiAgICAgICAgICBdXT48L2NvZGU+CiAgICAgICAgPC93aW5kb3ctbHVhPgogICAgICAgIDx3aW5kb3ctY29weSBuYW1lPSJ3X2NvcHkiPgogICAgICAgICAgICA8cmV0ZW50aW9uIHR5cGU9ImJ5dGltZV9zbGlkaW5nIj42MCBzZWNvbmRzPC9yZXRlbnRpb24+CiAgICAgICAgPC93aW5kb3ctY29weT4KICAgICAgICA8d2luZG93LWFnZ3JlZ2F0ZSBuYW1lPSJ3X2FnZ3IiPgogICAgICAgICAgPHNjaGVtYT4KICAgICAgICAgICAgPGZpZWxkcz4KICAgICAgICAgICAgICA8ZmllbGQgbmFtZT0iaXRlbSIgdHlwZT0ic3RyaW5nIiBrZXk9InRydWUiLz4KICAgICAgICAgICAgICA8ZmllbGQgbmFtZT0iY291bnQiIHR5cGU9ImludDMyIi8+CiAgICAgICAgICAgICAgPGZpZWxkIG5hbWU9Im1pbl9zY29yZSIgdHlwZT0iZG91YmxlIi8+CiAgICAgICAgICAgICAgPGZpZWxkIG5hbWU9Im1heF9zY29yZSIgdHlwZT0iZG91YmxlIi8+CiAgICAgICAgICAgICAgPGZpZWxkIG5hbWU9ImF2Z19zY29yZSIgdHlwZT0iZG91YmxlIi8+CiAgICAgICAgICAgIDwvZmllbGRzPgogICAgICAgICAgPC9zY2hlbWE+CiAgICAgICAgICA8b3V0cHV0PgogICAgICAgICAgICA8ZmllbGQtZXhwcj5FU1BfYUNvdW50KCk8L2ZpZWxkLWV4cHI+CiAgICAgICAgICAgIDxmaWVsZC1leHByPkVTUF9hTWluKHNjb3JlKTwvZmllbGQtZXhwcj4KICAgICAgICAgICAgPGZpZWxkLWV4cHI+RVNQX2FNYXgoc2NvcmUpPC9maWVsZC1leHByPgogICAgICAgICAgICA8ZmllbGQtZXhwcj5FU1BfYUF2ZShzY29yZSk8L2ZpZWxkLWV4cHI+CiAgICAgICAgICA8L291dHB1dD4KICAgICAgICA8L3dpbmRvdy1hZ2dyZWdhdGU+CiAgICAgIDwvd2luZG93cz4KICAgICAgPGVkZ2VzPgogICAgICAgIDxlZGdlIHNvdXJjZT0id19kYXRhIiB0YXJnZXQ9IndfcHl0aG9uMSIgcm9sZT0iZGF0YSIvPgogICAgICAgIDxlZGdlIHNvdXJjZT0id19yZWFkZXIiIHRhcmdldD0id19zY29yZSIgcm9sZT0ibW9kZWwiLz4KICAgICAgICA8ZWRnZSBzb3VyY2U9IndfcHl0aG9uMSIgdGFyZ2V0PSJ3X3Njb3JlIiByb2xlPSJkYXRhIi8+CiAgICAgICAgPGVkZ2Ugc291cmNlPSJ3X3Njb3JlIiB0YXJnZXQ9IndfY2FsYyIgcm9sZT0iZGF0YSIvPgogICAgICAgIDxlZGdlIHNvdXJjZT0id19jYWxjIiB0YXJnZXQ9IndfY291bnQiLz4KICAgICAgICA8ZWRnZSBzb3VyY2U9IndfY291bnQiIHRhcmdldD0id19jb3B5Ii8+CiAgICAgICAgPGVkZ2Ugc291cmNlPSJ3X2NvcHkiIHRhcmdldD0id19hZ2dyIi8+CiAgICAgIDwvZWRnZXM+CiAgICA8L2NvbnRxdWVyeT4KICA8L2NvbnRxdWVyaWVzPgo8L3Byb2plY3Q+Cg=="
  name: onnx
  projectTemplate: # deployment template for the project, overridden by ESPServer; ((...)) means a placeholder for the operator to fill in, ports 31415 and 31416 will be replaced if the project is configured to use different ports.
    autoscale:
      minReplicas: 1
      maxReplicas: 1
      metrics:
        - type: Resource
          resource:
            name: cpu
            target:
              type: Utilization
              averageUtilization: 50
    deployment:
      apiVersion: ""
      kind: ESPTemplate
      spec:
        selector:
          matchLabels:
        template: # required
          spec: # required
            volumes:
              - name: data
                persistentVolumeClaim:
                  claimName: esp-pv
            containers:
              - name: ((PROJECT_SERVICE_NAME)) # DONT CHANGE THE NAME
                resources:
                  requests:
                    memory: "1Gi"
                    cpu: "1"
                  limits:
                    memory: "2Gi"
                    cpu: "2"
                env:
                  - name: PYTHONPATH
                    value: /mnt/data/onnx
                volumeMounts:
                  - mountPath: /mnt/data # path persistent volume gets mounted to
                    name: data # the volume specified below
                    #                   subPath: roleve
  loadBalancerTemplate: # deployment template for the project, overridden by ESPServer; ((...)) means a placeholder for the operator to fill in, ports 31415 and 31416 will be replaced if the project is configured to use different ports.
    deployment:
      apiVersion: ""
      kind: ESPTemplate
      spec: # required for deployment spec
        template: # required
          spec: # required
            containers:
              - name: ((PROJECT_SERVICE_NAME))
